services:
    _defaults:
        autowire: true
        autoconfigure: true

    App\Framework\Application\Command\CommandBusInterface: '@App\Framework\Infrastructure\Symfony\Messenger\SymfonyCommandBus'

    App\Framework\Domain\Model\Event\AggregateEventsBusInterface: '@App\Framework\Infrastructure\Symfony\Messenger\SymfonyAggregateEventBus'

    App\Framework\Domain\Repository\TransactionBoundaryInterface: '@App\Framework\Infrastructure\Doctrine\DbalTransactionBoundary'

    App\Framework\Infrastructure\Doctrine\:
        resource: '../src/Framework/Infrastructure/Doctrine'

    App\Framework\Infrastructure\Symfony\Messenger\SymfonyAggregateEventBus:
        arguments:
            $aggregateEventBus: '@aggregate_event.bus'

    App\Framework\Infrastructure\Symfony\Messenger\SymfonyCommandBus:
        arguments:
            $commandBus: '@command.bus'

    App\RaffleDemo\Raffle\Application\:
        resource: '../src/RaffleDemo/Raffle/Application'

    App\RaffleDemo\Raffle\Domain\Model\Event\RaffleEventFactory: ~

    App\RaffleDemo\Raffle\Domain\Repository\RaffleEventStoreRepository:
        arguments:
            $eventStore: '@App\RaffleDemo\Raffle\Infrastructure\Postgres\Repository\PostgresRaffleEventStore'

    App\RaffleDemo\Raffle\Infrastructure\Postgres\Repository\PostgresRaffleEventStore:
        arguments:
            $aggregateEventFactory: '@App\RaffleDemo\Raffle\Domain\Model\Event\RaffleEventFactory'
            $domain: 'raffle'

    App\RaffleDemo\Raffle\UserInterface\Rest\V1\:
        resource: '../src/RaffleDemo/Raffle/UserInterface/Rest/V1'

    _instanceof:
        App\Framework\Application\Command\CommandHandlerInterface:
            tags:
                - { name: messenger.message_handler, bus: command.bus }
